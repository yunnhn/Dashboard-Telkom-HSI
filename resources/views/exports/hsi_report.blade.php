<table>
    <thead>
        <tr>
            <td colspan="33" style="font-weight: bold; font-size: 16px; text-align: center; height: 30px; vertical-align: middle;">PERFORMANCE REPORT HSI PER WITEL</td>
        </tr>
        <tr></tr>

        <tr style="font-weight: bold; text-align: center; color: #ffffff;">
            <th rowspan="4" style="background-color: #3e81f4; text-align: center; vertical-align: middle; border: 1px solid #000000; width: 35px;">WITEL</th>
            <th rowspan="4" style="background-color: #3e81f4; text-align: center; vertical-align: middle; border: 1px solid #000000;">PRE PI</th>
            <th rowspan="4" style="background-color: #3e81f4; text-align: center; vertical-align: middle; border: 1px solid #000000;">REGISTERED (RE)</th>
            <th rowspan="4" style="background-color: #6b717f; text-align: center; vertical-align: middle; border: 1px solid #000000;">INPRO SC</th>
            <th rowspan="4" style="background-color: #6b717f; text-align: center; vertical-align: middle; border: 1px solid #000000;">QC 1</th>
            <th rowspan="4" style="background-color: #6b717f; text-align: center; vertical-align: middle; border: 1px solid #000000;">FCC</th>
            <th rowspan="4" style="background-color: #e65253; text-align: center; vertical-align: middle; border: 1px solid #000000;">RJCT FCC</th>
            <th rowspan="4" style="background-color: #6b717f; text-align: center; vertical-align: middle; border: 1px solid #000000;">SURVEY MANJA</th>
            <th rowspan="4" style="background-color: #6b717f; text-align: center; vertical-align: middle; border: 1px solid #000000;">UN-SC</th>

            <th colspan="13" style="background-color: #6b717f; text-align: center; border: 1px solid #000000;">OGP</th>

            <th rowspan="4" style="background-color: #24c55f; text-align: center; vertical-align: middle; border: 1px solid #000000;">JML COMP (PS)</th>

            <th colspan="5" style="background-color: #e65253; text-align: center; border: 1px solid #000000;">CANCEL</th>

            <th rowspan="4" style="background-color: #e65253; text-align: center; vertical-align: middle; border: 1px solid #000000;">REVOKE</th>

            <th colspan="3" style="background-color: #3e81f4; text-align: center; border: 1px solid #000000;">PERFORMANCE</th>
        </tr>

        <tr style="font-weight: bold; text-align: center; color: #ffffff;">
            <th colspan="3" style="background-color: #6b717f; text-align: center; border: 1px solid #000000;">PI</th>
            <th rowspan="3" style="background-color: #6b717f; text-align: center; vertical-align: middle; border: 1px solid #000000;">TOTAL PI</th>
            <th colspan="7" style="background-color: #6b717f; text-align: center; border: 1px solid #000000;">FALLOUT</th>
            <th rowspan="3" style="background-color: #6b717f; text-align: center; vertical-align: middle; border: 1px solid #000000;">TOTAL FALLOUT</th>
            <th rowspan="3" style="background-color: #6b717f; text-align: center; vertical-align: middle; border: 1px solid #000000;">ACT COMP (QC2)</th>

            <th rowspan="3" style="background-color: #e65253; text-align: center; vertical-align: middle; border: 1px solid #000000;">KNDL Plgn</th>
            <th rowspan="3" style="background-color: #e65253; text-align: center; vertical-align: middle; border: 1px solid #000000;">KNDL Teknis</th>
            <th rowspan="3" style="background-color: #e65253; text-align: center; vertical-align: middle; border: 1px solid #000000;">KNDL System</th>
            <th rowspan="3" style="background-color: #e65253; text-align: center; vertical-align: middle; border: 1px solid #000000;">KNDL Others</th>
            <th rowspan="3" style="background-color: #e65253; text-align: center; vertical-align: middle; border: 1px solid #000000;">TOTAL CANCEL</th>

            <th rowspan="3" style="background-color: #3e81f4; text-align: center; vertical-align: middle; border: 1px solid #000000;">PI/RE</th>
            <th rowspan="3" style="background-color: #3e81f4; text-align: center; vertical-align: middle; border: 1px solid #000000;">PS/RE</th>
            <th rowspan="3" style="background-color: #3e81f4; text-align: center; vertical-align: middle; border: 1px solid #000000;">PS/PI</th>
        </tr>

        <tr style="font-weight: bold; text-align: center; color: #ffffff;">
            <th rowspan="2" style="background-color: #6b717f; text-align: center; vertical-align: middle; border: 1px solid #000000;">&lt; 1 Hari</th>
            <th rowspan="2" style="background-color: #6b717f; text-align: center; vertical-align: middle; border: 1px solid #000000;">1-3 Hari</th>
            <th rowspan="2" style="background-color: #6b717f; text-align: center; vertical-align: middle; border: 1px solid #000000;">&gt; 3 Hari</th>

            <th colspan="4" style="background-color: #6b717f; text-align: center; border: 1px solid #000000;">WFM</th>
            <th rowspan="2" style="background-color: #6b717f; text-align: center; vertical-align: middle; border: 1px solid #000000;">UIM</th>
            <th rowspan="2" style="background-color: #6b717f; text-align: center; vertical-align: middle; border: 1px solid #000000;">ASP</th>
            <th rowspan="2" style="background-color: #6b717f; text-align: center; vertical-align: middle; border: 1px solid #000000;">OSM</th>
        </tr>

        <tr style="font-weight: bold; text-align: center; color: #ffffff;">
            <th style="background-color: #6b717f; text-align: center; border: 1px solid #000000;">KNDL Plgn</th>
            <th style="background-color: #6b717f; text-align: center; border: 1px solid #000000;">KNDL Teknis</th>
            <th style="background-color: #6b717f; text-align: center; border: 1px solid #000000;">KNDL System</th>
            <th style="background-color: #6b717f; text-align: center; border: 1px solid #000000;">KNDL Others</th>
        </tr>
    </thead>

    <tbody>
        @foreach($reportData as $row)
            <tr>
                <td style="border: 1px solid #000000; vertical-align: middle; text-align: left; {{ $row->row_type === 'main' ? 'font-weight: bold; background-color: #f1f5f9;' : 'padding-left: 20px;' }}">
                    {{ $row->witel_display }}
                </td>

                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $row->pre_pi }}</td>
                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $row->registered }}</td>
                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $row->inprogress_sc }}</td>
                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $row->qc1 }}</td>
                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $row->fcc }}</td>
                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $row->cancel_by_fcc }}</td>
                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $row->survey_new_manja }}</td>
                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $row->unsc }}</td>

                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $row->pi_under_1_hari }}</td>
                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $row->pi_1_3_hari }}</td>
                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $row->pi_over_3_hari }}</td>
                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle; background-color: #f8fafc;">{{ $row->total_pi }}</td>

                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $row->fo_wfm_kndl_plgn }}</td>
                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $row->fo_wfm_kndl_teknis }}</td>
                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $row->fo_wfm_kndl_sys }}</td>
                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $row->fo_wfm_others }}</td>

                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $row->fo_uim }}</td>
                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $row->fo_asp }}</td>
                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $row->fo_osm }}</td>
                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle; background-color: #f8fafc;">{{ $row->total_fallout }}</td>

                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $row->act_comp }}</td>
                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle; background-color: #f8fafc;">{{ $row->jml_comp_ps }}</td>

                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $row->cancel_kndl_plgn }}</td>
                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $row->cancel_kndl_teknis }}</td>
                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $row->cancel_kndl_sys }}</td>
                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $row->cancel_others }}</td>
                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle; background-color: #f8fafc;">{{ $row->total_cancel }}</td>

                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $row->revoke }}</td>

                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $row->pi_re_percent }}%</td>
                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle; font-weight: bold; color: #ffffff; background-color: {{ $row->ps_re_percent >= 80 ? '#24c55f' : '#e65253' }};">
                    {{ $row->ps_re_percent }}%
                </td>
                <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $row->ps_pi_percent }}%</td>
            </tr>
        @endforeach
    </tbody>

    <tfoot>
        <tr style="text-align: center; background-color: #cccccc; font-weight: bold; color: #464647; border: 2px solid #000000;">
            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">TOTAL</td>
            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->pre_pi }}</td>
            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->registered }}</td>
            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->inprogress_sc }}</td>
            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->qc1 }}</td>
            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->fcc }}</td>
            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->cancel_by_fcc }}</td>
            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->survey_new_manja }}</td>
            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->unsc }}</td>

            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->pi_under_1_hari }}</td>
            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->pi_1_3_hari }}</td>
            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->pi_over_3_hari }}</td>
            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->total_pi }}</td>

            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->fo_wfm_kndl_plgn }}</td>
            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->fo_wfm_kndl_teknis }}</td>
            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->fo_wfm_kndl_sys }}</td>
            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->fo_wfm_others }}</td>

            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->fo_uim }}</td>
            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->fo_asp }}</td>
            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->fo_osm }}</td>
            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->total_fallout }}</td>

            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->act_comp }}</td>
            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->jml_comp_ps }}</td>

            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->cancel_kndl_plgn }}</td>
            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->cancel_kndl_teknis }}</td>
            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->cancel_kndl_sys }}</td>
            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->cancel_others }}</td>
            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->total_cancel }}</td>

            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->revoke }}</td>

            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->pi_re_percent }}%</td>
            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle; color: #ffffff; background-color: {{ $totals->ps_re_percent >= 80 ? '#24c55f' : '#e65253' }};">
                {{ $totals->ps_re_percent }}%
            </td>
            <td style="border: 1px solid #000000; text-align: center; vertical-align: middle;">{{ $totals->ps_pi_percent }}%</td>
        </tr>
    </tfoot>
</table>